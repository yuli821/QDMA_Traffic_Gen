`timescale 1ns / 1ps
//////////////////////////////////////////////////////////////////////////////////
// Company: 
// Engineer: 
// 
// Create Date: 10/15/2025 06:14:22 AM
// Design Name: 
// Module Name: toeplitz_hash
// Project Name: 
// Target Devices: 
// Tool Versions: 
// Description: 
// 
// Dependencies: 
// 
// Revision:
// Revision 0.01 - File Created
// Additional Comments:
// 
//////////////////////////////////////////////////////////////////////////////////


module toeplitz_hash(
    // SRC_IP | DEST_IP | SRC_PORT | DEST_PORT
    // DEST_IP | SRC_IP | SRC_PORT | DEST_PORT
    input logic  [95:0] tuple_input,
    output logic [31:0] hash_out_1,
    output logic [31:0] hash_out_2
);

localparam logic [95:0] MATRIX_1 [31:0] = '{
    96'hAF76663F13494DCB5358756F,
    96'h7FACBA2E5B2CFA73FA501144,
    96'h9C3180F746383E9969809E0F,
    96'h5CB1572E09810B411710D1E9,
    96'h15714B9871096225DE0F2CFF,
    96'h990038EBA58694E188BE6944,
    96'h857CCFEE8CE71FCB7CC15EE9,
    96'hB4CD19073FFF0BFF8FF4CC54,
    96'h8DF7394453D5E5F428DC458C,
    96'hED76F6E3A2C6D536D7817E98,
    96'hAE4A22C7079BAD201B347B03,
    96'hBBA7A024BB7598EE93CEC824,
    96'h00605BF0E36E9157DC960738,
    96'hDE75644F6F956F5F6DF097CD,
    96'hE7DDCC929D031DED16334674,
    96'hE0CEB343F9BA36E0601939D2,
    96'hE61D1D3D112DBD3C58C7BA8E,
    96'h95B00D08063C7BCEE1EEB3F3,
    96'hE76ECC111B382DA0E1782784,
    96'h3EBD346D6E2157416BF952D9,
    96'h7A2BBD8F75AF35A7ED07A044,
    96'h02B56D09AB6A8E5D41F45066,
    96'h3AF588364F2E7A7216C47658,
    96'h0FDA43AD20C1DEA729D433C7,
    96'h100A42533DF5D24AE6212FF9,
    96'h24E8FAFEFC991E3DC4BAD3D7,
    96'hCC5C8444F737667A0C5A73D4,
    96'hF574B13FABFD07143790D4A9,
    96'hC4F6A8A1AFDFFBBF546B9AE5,
    96'h88B61F879F19F17709C8CF2B,
    96'h9A4990EF37EDC74175D3A70E,
    96'h6AA09D830B32F3DF4BFC851E
};

localparam logic [95:0] MATRIX_2 [31:0] = '{
    96'h68C0C87FF68F8CFFC4951CD0,
    96'h3CA7223CFD4B747AC11818A3,
    96'h64B37936439D31B32C55EA40,
    96'h90563AE19B92DD32B24F9A59,
    96'h15026C16C7597CD20189668D,
    96'hC1CB61A756B578561E987A7A,
    96'h6EBAD7D41266950904FC3E2A,
    96'h239665B7A9F32B63DBD928B2,
    96'h4F2D8A7F66BBC964A58FAA79,
    96'hC345DDD37689604981626134,
    96'hD81445DBEC7900554C256B67,
    96'hFDDC20F3A735EDF20861520D,
    96'h70609D1653D83D1CE3AFFF63,
    96'h13AD52DB6782285D387C59C8,
    96'hE57D4448F339A6AAC3B3C8B7,
    96'h701D11043BB4555DB1F936E9,
    96'hAB3334D4431A63AFE4AA2765,
    96'hC58F6A728C1103E611D92E47,
    96'h75FBDC8ACAE8D98032286877,
    96'hF7A3C44E5E9FB98226684227,
    96'h03212FFB45D3C655FCCD398C,
    96'hC972C144DD575D184C3EAE99,
    96'h41D7E68E74ED19BAD4EB95B9,
    96'h22CC48199E6A64EC95245DC4,
    96'h8C3DE39FADFD59CF480EF3CF,
    96'h68212E1B42D0492AE6F87D38,
    96'hEBCAD0123A71EB8408967D01,
    96'h80CFCDD0057F32AEE018CFE3,
    96'h13269A1B316BC43DB6C87F2C,
    96'h9F6D3847C47E140D6496FE14,
    96'h6B80D8E30E0BA5CF0E41B783,
    96'h5313E48E5FF86D41EF41D526
};

logic [95:0] hash_and_1 [32];
logic [95:0] hash_and_2 [32];

genvar i;
generate
    for (i = 0; i < 32; i++) begin
        assign hash_and_1[i] = tuple_input & MATRIX_1[i];
        assign hash_and_2[i] = tuple_input & MATRIX_2[i];

        assign hash_out_1[i] = ^hash_and_1[i];
        assign hash_out_2[i] = ^hash_and_2[i];
    end
endgenerate

endmodule